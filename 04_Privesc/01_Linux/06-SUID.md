tags: #suid

- find files own by current user with `s` suid permission, `example -rwsr-xr-x`
	- `find / -perm  -u=s -type f 2>& /dev/null`
- Search for all result from the above command in [GTFObins](https://gtfobins.github.io/) and try to find if one of them is vuln.

##### via Shared Object

- `find / -type f -perm 04000 -ls 2> /dev/null`
- look for `/usr/local/bin/suid-so` and run it using the following command
- `strace /usr/local/bin/suid-so | grep -i -E "open|access|no such file"`
- 


##### via Binary Symlink

When a binary has the SUID (Set User ID) permission set, it runs with the privileges of the file owner rather than the user who executes it. This can lead to privilege escalation if the binary is vulnerable to exploitation.

To find files owned by the current user with the SUID permission, you can use the following command:

- `find / -perm -u=s -type f 2>/dev/null`

Once you find a vulnerable binary, you can search for exploits in [GTFOBins](https://gtfobins.github.io/) to see if there's a known vulnerability that allows privilege escalation.

##### via Environmental Variable

Another method for exploiting SUID binaries involves manipulating environmental variables. If a SUID binary invokes a command or script that relies on user-controlled environmental variables without proper validation, it may be vulnerable to privilege escalation.

To search for SUID binaries on the system, you can use:

 - `find / -type f -perm 04000 -ls 2>/dev/null`
	 - example: `-rwsr-xr-x 1 root root 12345 Jan 1 12:00 /usr/local/bin/suid-so`

Once you've identified a SUID binary, you can look for any environmental variables it may use and attempt to exploit them. For example, suppose the binary `/usr/local/bin/suid-so` relies on the `LD_LIBRARY_PATH` environmental variable. You can set this variable to a directory you control and include a malicious shared object file (`malicious.so`) to execute arbitrary code:

```
export LD_LIBRARY_PATH=/path/to/malicious/dir /usr/local/bin/suid-so
```

By abusing environmental variables, you may be able to escalate privileges and gain unauthorized access to system resources.
