
##### We can use one of the following commands to enum SMB and NetBIOS


 - `nmap -v -p 139,445 -oG smb.txt 192.168.50.1-254`
 - `sudo nbtscan -r 192.168.50.0/24`
 - `nbtscan -v $ip_add`
	 - hex code reference [http://www.pyeung.com/pages/microsoft/winnt/netbioscodes.html](http://www.pyeung.com/pages/microsoft/winnt/netbioscodes.html)

 - `nmap -v -p 139,445 --script smb* 192.168.50.152`
	 - more smb nmap scripts can be found under
		 - `ls -l /usr/share/nmap/scripts/smb*`
- `smbclient -L $ip_add`: to list all the shares
	- anonymous login `smbclient -L //$ip_add`
	- try if access the share without password `smbclient //$ip_add/SHARE_NAME$`
- `crackmapexec`
	- `crackmapexec $ip_add` basic info gathering on a machine
	- `crackmapexec $ip_add -u $username -p $password --shares` enumerating shares
	- `crackmapexec $ip_add -i $username -p $password --users` enumerating users
	- lateral movement - if we have valid credential for one system we can attempt lateral mov't to other systems within the network.
		- `crackmapexec $ip_add -u $username -p $password --exec-command <$command>`
- `nmblookup -A $ip_add`: to get more info on a system
- `enum4linux -a $ip_add`: this is deprecated 

- Brute-forcing smb:
	- `hydra -l [USER] -P /usr/share/seclists/Passwords/darkweb2017-top1000.txt smb://$ip_add/ -V -I`
	- or we can use nmap script here.

- `SambaCry` and `EternalBlue` might be there:
	- `nmap --script smb-vuln-cve-2017-7494 --script-args smb-vuln-cve-2017-7494.check-version -p445 $ip_add -Pn`

##### How to map a share in Linux

 - `sudo mount -t cifs //$ip_add/SHARE ~/mnt -o username=$usernaem,password=$password`

