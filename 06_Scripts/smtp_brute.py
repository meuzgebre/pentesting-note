#!/bin/env python3
# AUthor: Meuz Kidane
# https://github.com/meuzgebre

import socket
import sys

def read_wordlist(path:str):
    with open(path, "r") as file:
        users = file.readlines()

    return users

def smtp_brute(ip_add:str, users:list):
    # Init Socket
    s = socket.socket()

    # Connect to SMTP server
    s.connect((ip_add, 25))

    # Reseting the connection after 10 try might help with error

    for user in users:
        
        # Send username to check
        s.send(b"VRFY {user} \r\n")

        print(s.recv(1024).decode())


if __name__ == "__main__":

    # Args
    if(len(sys.argv) != 3):
        print(f"Usage {sys.argv[0]} <ip_add> <wordlist>")
    else:
        users = read_wordlist("users.txt")
        smtp_brute(ip_add=sys.argv[1], users=sys.argv[2])


